<ion-header>
  <ion-toolbar>
    <ion-title>Perfil</ion-title>
  </ion-toolbar>
</ion-header>

<ion-content class="ion-padding">
  <ion-card>
    <ion-card-header>
      <ion-card-title>Bienvenido, {{ user.email }}</ion-card-title>
    </ion-card-header>
    <ion-card-content>
      <p>Aquí puedes ver tus reportes y recibir notificaciones si se encuentran tus autos reportados.</p>
    </ion-card-content>
  </ion-card>

  <ion-list>
    <ion-list-header>
      <ion-label>Notificaciones</ion-label>
    </ion-list-header>

    <ion-item *ngFor="let reporte of reportes">
      <ion-label>
        <h2>Auto Reportado: {{ reporte.patente }}</h2>
        <p>Descripción: {{ reporte.descripcion }}</p>
        <p *ngIf="reporte.direccion">Visto en: {{ reporte.direccion }}</p>
        <p *ngIf="reporte.foto">Foto: {{ reporte.foto }}</p>
        <p *ngIf="reporte.status === 'Robado'">Estado: Robado</p>
        <p *ngIf="reporte.status === 'Recuperado'">Estado: Recuperado</p>
      </ion-label>

      <ion-list *ngIf="obtenerNotificaciones(reporte).length > 0">
        <ion-list-header>
          <ion-label>Notificaciones Recibidas</ion-label>
        </ion-list-header>
        <ion-item *ngFor="let notificacion of obtenerNotificaciones(reporte)">
          <ion-label>
            <h3>{{ notificacion.mensaje }}</h3>
            <p>Visto en: {{ notificacion.direccion }}</p>
            <p *ngIf="notificacion.foto">Foto: {{ notificacion.foto }}</p>
          </ion-label>
        </ion-item>
      </ion-list>

      <ion-button *ngIf="reporte.status === 'Robado'" (click)="marcarRecuperado(reporte.id)">
        Marcar como Recuperado
      </ion-button>
    </ion-item>
  </ion-list>
</ion-content>
